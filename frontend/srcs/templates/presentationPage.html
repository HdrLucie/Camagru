<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"> -->
<!DOCTYPE html>

<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>Camagru</title>
	<!-- <link rel="stylesheet" href="/frontend/srcs/static/styles/presentationPage.scss"/> -->
</head>

<body>
	<div class="main">
		<input type="checkbox" id="chk" aria-hidden="true">
		<div class="signup">
			<form method="POST" onsubmit="return false">
				<label for="chk" aria-hidden="true">Sign up</label>
				<input type="text" id="Username" name="txt" placeholder="Username">
				<input type="email" id="Email" name="email" placeholder="Email">
				<input type="password" id="Password" name="pswd" placeholder="Password">
				<button class="btn" id="signUp">Sign up</button>
			</form>
		</div>
		<div class="login">
			<form method="POST" action="login">
				<label for="chk" aria-hidden="true">Login</label>
				<input type="text" placeholder="Username" id="UsernameLogin">
				<input type="password" placeholder="Password" id="PasswordLogin">
				<button class="btn" id="login">Sign in</button>
			</form>
		</div>
	</div>
</body>

<script>
	document.getElementById("signUp").onclick = async function () {
		var tmpUser = document.getElementById("Username")
		var tmpEmail = document.getElementById("Email")
		var tmpPassword = document.getElementById("Password")

		var login = tmpUser.value
		var email = tmpEmail.value
		var password = tmpPassword.value

		console.log("Login : " + login + " Email : " + email + " Mdp : " + password)
		if (login == "" || email == "" || password == "") {
			alert("Wrong username, email or password")
			// return
		}
		try {
			const response = await fetch("/signUp", {
				method: "POST",
				headers: {
					"Content-Type": "application/json"
				},
				body: JSON.stringify({
					"email": email,
					"username": login,
					"password": password
				})
			});
			if (!response.ok) {
				throw new Error(`HTTP error! status: ${response.status}`);
			}

			const data = await response.json();
			if (response.status === 201) {
				alert("User created successfully");
				window.location.href = "/gallery"
			} else {
				alert(`Error creating user: ${data.message}`);
			}
		} catch (error) {
			console.error("Error: ", error);
			alert(`Error creating user: ${error.message}`);
		}
	}

	document.getElementById("login").onclick = function () {
		var user = document.getElementById("UsernameLogin")
		var mdp = document.getElementById("PasswordLogin")

		var login = user.value
		var password = mdp.value
		try {
			fetch("/login", {
				method: "POST",
				headers: {
					"Content-Type": "application/json"
				},
				body: JSON.stringify({
					Username: login,
					Password: password
				})
			})
				.then(response => response.json())
				.then(data => {
					console.log(data.message);
					alert("Successfully connected");
					const redirectPath = data.redirectPath;
					window.location.href = redirectPath;
				})
		} catch (error) {
			console.error("Error:", error);
			alert("Wrong username or password");
		}
	}
</script>

</html>

<style>
	@import url("https://fonts.googleapis.com/css2?family=Quicksand:wght@300&display=swap");

	/* * {
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		-ms-overflow-style: none;
		box-sizing: border-box;
		margin: 0;
		padding: 0;
		font-family: 'Righteous', cursive;
		text-rendering: optimizeLegibility;
		font-size: 20px;
	}

	::-webkit-scrollbar {
		width: 0;
		height: 0;
		background: transparent;
	}


	/* body {
		display: flex;
		justify-content: center;
		align-items: center;
		min-height: 100vh;
		background: #111;
		width: 100%;
		overflow: hidden;
	} */

	::-webkit-scrollbar {
		width: 0;
		height: 0;
		background: transparent;
	}

	body {
		margin: 0;
		padding: 0;
		display: flex;
		justify-content: center;
		align-items: center;
		min-height: 100vh;
		font-family: 'Jost', sans-serif;
		background: #111;
	}

	.main {
		width: 350px;
		height: 500px;
		background: #000;
		overflow: hidden;
		border-radius: 10px;
		box-shadow: 5px 20px 50px #000;
	}

	#chk {
		display: none;
	}

	.signup {
		position: relative;
		width: 100%;
		height: 100%;
	}

	label {
		color: #fff;
		font-size: 2.3em;
		justify-content: center;
		display: flex;
		margin: 50px;
		font-weight: bold;
		cursor: pointer;
		transition: .5s ease-in-out;
	}

	input {
		width: 60%;
		height: 10px;
		background: #e0dede;
		justify-content: center;
		display: flex;
		margin: 20px auto;
		padding: 12px;
		border: none;
		outline: none;
		border-radius: 5px;
	}

	.btn {
		width: 60%;
		height: 40px;
		margin: 10px auto;
		justify-content: center;
		display: block;
		color: #fff;
		background: #DBA3B5;
		font-size: 1em;
		font-weight: bold;
		margin-top: 30px;
		outline: none;
		border: none;
		border-radius: 5px;
		transition: .2s ease-in;
		cursor: pointer;
	}

	.btn:hover {
		background: #DBA3B5;
	}

	.login {
		height: 460px;
		background: #eee;
		border-radius: 60% / 10%;
		transform: translateY(-180px);
		transition: .8s ease-in-out;
	}

	.login label {
		color: #DBA3B5;
		transform: scale(.6);
	}

	#chk:checked~.login {
		transform: translateY(-500px);
	}

	#chk:checked~.login label {
		transform: scale(1);
	}

	#chk:checked~.signup label {
		transform: scale(.6);
	}
</style>